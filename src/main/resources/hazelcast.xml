<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2008-2022, Hazelcast, Inc. All Rights Reserved.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--
  The default Hazelcast configuration.

  This XML file is used when no hazelcast.xml is present.

  To learn how to configure Hazelcast, please see the schema at
  https://hazelcast.com/schema/config/hazelcast-config-5.1.xsd
  or the Reference Manual at https://docs.hazelcast.com/
-->

<!--suppress XmlDefaultAttributeValue -->
<hazelcast xmlns="http://www.hazelcast.com/schema/config"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.hazelcast.com/schema/config
           http://www.hazelcast.com/schema/config/hazelcast-config-5.1.xsd">

    <!--
        The name of the cluster. All members of a single cluster must have the same cluster name
        configured and a client connecting to this cluster must use it as well.
    -->
    <cluster-name>${io.xh.hoist.hzClusterName}</cluster-name>
    <instance-name>${io.xh.hoist.hzInstanceName} </instance-name>

    <properties>
        <property name="hazelcast.health.monitoring.level">SILENT</property>
    </properties>

    <!--
        NOTE - network block below is specific to the XH Toolbox deployment within AWS Fargate!
        See https://docs.hazelcast.com/hazelcast/latest/deploy/deploying-on-aws#ecsfargate-configuration
    -->
    <network>
        <join>
            <multicast enabled="false"/>
            <aws enabled="true" />
        </join>
        <interfaces enabled="true">
            <interface>172.30.*.*</interface>
        </interfaces>
    </network>

    <cache name="io.xh.hoist.track.TrackLog">
        <statistics-enabled>true</statistics-enabled>
        <management-enabled>true</management-enabled>
        <eviction size="10000" max-size-policy="ENTRY_COUNT" eviction-policy="LRU" />
    </cache>

    <!--
        Default Hibernate 2nd Level Cache
     -->
    <map name="default">

        <!--
            Maximum number of seconds for each entry to stay in the map. Entries that are
            older than <time-to-live-seconds> and not updated for <time-to-live-seconds>
            will get automatically evicted from the map.
            Any integer between 0 and Integer.MAX_VALUE. 0 means infinite. Default is 0
        -->
        <time-to-live-seconds>99</time-to-live-seconds>
        <!--
            Maximum number of seconds for each entry to stay idle in the map. Entries that are
            idle(not touched) for more than <max-idle-seconds> will get
            automatically evicted from the map. Entry is touched if get, put or containsKey is called.
            Any integer between 0 and Integer.MAX_VALUE. 0 means infinite. Default is 0.
        -->
        <max-idle-seconds>0</max-idle-seconds>

        <eviction eviction-policy="LRU" max-size-policy="PER_NODE" size="10000"/>
        <statistics-enabled>true</statistics-enabled>
        <per-entry-stats-enabled>true</per-entry-stats-enabled>
    </map>

    <!--
        Hibernate plumbing caches.
    -->
    <map name="org.hibernate.cache.StandardQueryCache">
        <time-to-live-seconds>86400</time-to-live-seconds>
        <eviction eviction-policy="LRU" max-size-policy="PER_NODE" size="5000"/>

    </map>

    <map name="org.hibernate.cache.UpdateTimestampsCache">
        <time-to-live-seconds>0</time-to-live-seconds>
        <eviction eviction-policy="LRU" max-size-policy="PER_NODE" size="5000"/>
    </map>

</hazelcast>
